!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).WeSignal={})}(this,(function(e){"use strict";function t(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var r=Symbol("Signal-Create"),i=function(){function e(t,i,n,o,a){if(void 0===a&&(a=e.Features.exact),this.type=i,this.data=n,this.origin=o,this.feature=a,t!==r)throw new Error("Please use [Signal.create]")}return e.create=function(t,i,n,o){return void 0===o&&(o=e.Features.exact),new e(r,t,i,n,o)},e.Features={exact:"exact",upward:"upward",downward:"downward",whole:"whole"},e}(),n=Symbol("Listener-Create"),o=function(){function e(e,t,r,o,a,s,c){if(void 0===a&&(a=null),void 0===s&&(s=-1),void 0===c&&(c=i.Features.exact),this.type=t,this.handler=r,this.emitter=o,this.context=a,this.count=s,this.catchFeature=c,e!==n)throw new Error("Please use [Listener.create]")}return Object.defineProperty(e.prototype,"active",{get:function(){return 0!==this.count},enumerable:!1,configurable:!0}),e.prototype.handle=function(e){if(this.active&&this.type===e.type){var t=this.emitter===e.origin,r=this.catchFeature===i.Features.whole,n=this.catchFeature!==i.Features.exact&&e.feature===i.Features.whole,o=this.catchFeature===e.feature;(t||r||n||o)&&(this.count>0&&--this.count,this.handler.call(this.context,e))}},e.create=function(t,r,o,a,s,c){return void 0===a&&(a=null),void 0===s&&(s=-1),void 0===c&&(c=i.Features.exact),new e(n,t,r,o,a,s,c)},e}(),a=function(){function e(){this._parent=null,this._children=[],this.listeners={}}return Object.defineProperty(e.prototype,"totalListener",{get:function(){return Object.values(this.listeners).reduce((function(e,t){return e+t.length}),0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){var t=this._parent;e!==t&&(this._parent=e,t&&t.removeChild(this),e&&e.addChild(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),e.prototype.addChild=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach((function(t){e.hasChild(t)||(e._children.push(t),t.parent!==e&&(t.parent=e))}))},e.prototype.removeChild=function(){for(var e=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.length||(r=t([],this.children,!0)),r.forEach((function(t){var r=e.getChildIndex(t);r>-1&&(e._children.splice(r,1),t.parent===e&&(t.parent=null))}))},e.prototype.hasChild=function(e){return this._children.includes(e)},e.prototype.getChildIndex=function(e){return this._children.indexOf(e)},e.prototype.addListener=function(e,t,r,n,a){var s,c;return void 0===r&&(r=null),void 0===n&&(n=-1),void 0===a&&(a=i.Features.exact),!(!e||!t||0===n)&&(this.removeListener(e,t,r,a),null!==(s=(c=this.listeners)[e])&&void 0!==s||(c[e]=[]),this.listeners[e].push(o.create(e,t,this,r,n,a)),!0)},e.prototype.on=function(e,t,r,n,o){return void 0===r&&(r=null),void 0===n&&(n=-1),void 0===o&&(o=i.Features.exact),this.addListener(e,t,r,n,o)},e.prototype.once=function(e,t,r,n){return void 0===r&&(r=null),void 0===n&&(n=i.Features.exact),this.addListener(e,t,r,1,n)},e.prototype.removeListener=function(e,t,r,n){if(void 0===r&&(r=null),void 0===n&&(n=i.Features.exact),e)if(t){if(this.listeners[e]){for(var o=this.listeners[e],a=o.length-1;a>-1;){var s=o[a];t===s.handler&&r===s.context&&n===s.catchFeature&&o.splice(a,1),--a}o.length||delete this.listeners[e]}}else delete this.listeners[e];else this.listeners={}},e.prototype.off=function(e,t,r,n){return void 0===r&&(r=null),void 0===n&&(n=i.Features.exact),this.removeListener(e,t,r,n)},e.prototype.emit=function(e,t,r){void 0===r&&(r=i.Features.exact);var n=i.create(e,t,this,r);this.receive(n);var o=r===i.Features.whole;(o||r===i.Features.upward)&&this.emitUpWard(n),(o||r===i.Features.downward)&&this.emitDownWard(n)},e.prototype.destroy=function(){this.parent=null,this.removeChild(),this.removeListener()},e.prototype.receive=function(e){var t=this,r=e.type,i=this.listeners[r];if(null==i?void 0:i.length){var n=[];i.forEach((function(t){t.handle(e),t.active||n.push(t)})),n.forEach((function(e){t.removeListener(r,e.handler,e.context,e.catchFeature)}))}},e.prototype.emitUpWard=function(e){for(var t=this.parent;t;)t.receive(e),t=t.parent},e.prototype.emitDownWard=function(e){this.children.length&&this.children.forEach((function(t){t.receive(e),t.emitDownWard(e)}))},e}();e.Emitter=a,e.Signal=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=we-signal.min.js.map
