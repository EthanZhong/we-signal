!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).WeSignal={})}(this,(function(e){"use strict";var t=Symbol("Signal-Create"),r=function(){function e(r,i,n,o,a){if(void 0===a&&(a=e.Features.exact),this.type=i,this.data=n,this.origin=o,this.feature=a,r!==t)throw new Error("Please use [Signal.create]")}return e.create=function(r,i,n,o){return void 0===o&&(o=e.Features.exact),new e(t,r,i,n,o)},e.Features={exact:"exact",upward:"upward",downward:"downward",whole:"whole"},e}();function i(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var n=Symbol("Listener-Create"),o=function(){function e(e,t,i,o,a,s,c){if(void 0===a&&(a=null),void 0===s&&(s=-1),void 0===c&&(c=r.Features.exact),this.type=t,this.handler=i,this.emitter=o,this.context=a,this.count=s,this.catchFeature=c,e!==n)throw new Error("Please use [Listener.create]")}return Object.defineProperty(e.prototype,"active",{get:function(){return 0!==this.count},enumerable:!1,configurable:!0}),e.prototype.handle=function(e){if(this.active&&this.type===e.type){var t=this.emitter===e.origin,i=this.catchFeature===r.Features.whole,n=this.catchFeature!==r.Features.exact&&e.feature===r.Features.whole,o=this.catchFeature===e.feature;(t||i||n||o)&&(this.count>0&&--this.count,this.handler.call(this.context,e))}},e.create=function(t,i,o,a,s,c){return void 0===a&&(a=null),void 0===s&&(s=-1),void 0===c&&(c=r.Features.exact),new e(n,t,i,o,a,s,c)},e}(),a=function(){function e(){this._parent=null,this._children=[],this._listeners={}}return Object.defineProperty(e.prototype,"totalListener",{get:function(){return Object.values(this._listeners).reduce((function(e,t){return e+t.length}),0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){var t=this._parent;e!==t&&(t&&t.removeChild(this),e&&e.addChild(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),e.prototype.addChild=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.forEach((function(t){e.hasChild(t)||(e._children.push(t),t._parent=e)}))},e.prototype.removeChild=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];t.length||(t=i([],this.children,!0)),t.forEach((function(t){var r=e.getChildIndex(t);r>-1&&(e._children.splice(r,1),t._parent=null)}))},e.prototype.hasChild=function(e){return this._children.includes(e)},e.prototype.getChildIndex=function(e){return this._children.indexOf(e)},e.prototype.addListener=function(e,t,i,n,a){var s,c;return void 0===i&&(i=null),void 0===n&&(n=-1),void 0===a&&(a=r.Features.exact),!(!e||!t||0===n)&&(this.removeListener(e,t,i,a),null!==(s=(c=this._listeners)[e])&&void 0!==s||(c[e]=[]),this._listeners[e].push(o.create(e,t,this,i,n,a)),!0)},e.prototype.on=function(e,t,i,n,o){return void 0===i&&(i=null),void 0===n&&(n=-1),void 0===o&&(o=r.Features.exact),this.addListener(e,t,i,n,o)},e.prototype.once=function(e,t,i,n){return void 0===i&&(i=null),void 0===n&&(n=r.Features.exact),this.addListener(e,t,i,1,n)},e.prototype.removeListener=function(e,t,i,n){if(void 0===i&&(i=null),void 0===n&&(n=r.Features.exact),e)if(t){if(this._listeners[e]){for(var o=this._listeners[e],a=o.length-1;a>-1;){var s=o[a];t===s.handler&&i===s.context&&n===s.catchFeature&&o.splice(a,1),--a}o.length||delete this._listeners[e]}}else delete this._listeners[e];else this._listeners={}},e.prototype.off=function(e,t,i,n){return void 0===i&&(i=null),void 0===n&&(n=r.Features.exact),this.removeListener(e,t,i,n)},e.prototype.emit=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=r.Features.exact);var n=r.create(e,t,this,i);this.receive(n);var o=i===r.Features.whole;(o||i===r.Features.upward)&&this.emitUpWard(n),(o||i===r.Features.downward)&&this.emitDownWard(n)},e.prototype.destroy=function(){this.parent=null,this.removeChild(),this.removeListener()},e.prototype.receive=function(e){var t,r=this,i=e.type,n=null!==(t=this._listeners[i])&&void 0!==t?t:[];if(n.length){var o=[];n.forEach((function(t){t.handle(e),t.active||o.push(t)})),o.forEach((function(e){r.removeListener(i,e.handler,e.context,e.catchFeature)}))}},e.prototype.emitUpWard=function(e){for(var t=this.parent;t;)t.receive(e),t=t.parent},e.prototype.emitDownWard=function(e){this.children.length>0&&this.children.forEach((function(t){t.receive(e),t.emitDownWard(e)}))},e}();e.Emitter=a,e.Signal=r,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=we-signal.min.js.map
